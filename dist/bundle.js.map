{"version":3,"sources":["webpack://Perceptor/webpack/universalModuleDefinition","webpack://Perceptor/webpack/bootstrap","webpack://Perceptor/./src/config/defaultConfig.js","webpack://Perceptor/./src/config/helper.js","webpack://Perceptor/./src/subscribers/domSubscriber.js","webpack://Perceptor/./src/utils/view.js","webpack://Perceptor/./src/spectators/viewportSpectator.js","webpack://Perceptor/./src/spectators/timeSpectator.js","webpack://Perceptor/./src/spectators/elementSpectator.js","webpack://Perceptor/./src/spectators/durationSpectator.js","webpack://Perceptor/./src/spectators/defaultSpectators.js","webpack://Perceptor/./src/spectators/spectatorManager.js","webpack://Perceptor/./src/subscribers/subscriberManager.js","webpack://Perceptor/./src/schedulers/visibilityHelper.js","webpack://Perceptor/./src/schedulers/intervalScheduler.js","webpack://Perceptor/./src/index.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","defaultConfig","threshold","watchMode","watchInterval","subscribers","spectators","clickHandler","arrayMergeList","objectMergeList","isArray","candidate","Array","mainContainer","document","createElement","id","body","appendChild","style","backgroundColor","width","position","bottom","left","domSubscriber","perceptorInstance","context","innerHTML","JSON","stringify","undefined","paintObjectOnContainer","getCurrentViewport","documentElement","clientHeight","getCurrentScrollPosition","height","clientWidth","right","pageXOffset","top","pageYOffset","getCurrentViewportElementPosition","node","getBoundingClientRect","getElementPosition","scrollPos","viewPortSpectator","ele","element","view","isBoxed","config","container","nodeRight","containerRight","nodeBottom","containerBottom","leftCoordinates","rightCoordinates","topCoordinates","bottomCoordinates","subView","lc","rc","tc","bc","hasIntersectingArea","surface","isVisible","timeSpectator","time","Date","getTime","elementSpectator","pContext","tagName","durationSpectator","currentResult","prevResult","duration","defaultSpectators","SpectatorManager","[object Object]","chain","this","fn","push","length","perceptorContext","updatedResult","reduce","spectator","assign","SubscriberManager","PerceptorContext","data","every","subscribe","visibilityHelper_hidden","visibilityChange","hidden","msHidden","webkitHidden","onPageVisible","addEventListener","isPageVisible","intervalScheduler_IntervalScheduler","options","interval","spectatorChain","subscriberChain","_enabled","_schedule","handleId","setInterval","spectatorsResult","run","dispatch","clearInterval","src_Perceptor","DOMElement","baseConfig","extensionConfig","includes","mergeConfig","defaults","event","scheduler","clearSchedule","removeEventListener","__webpack_exports__"],"mappings":"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","file":"bundle.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"Perceptor\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Perceptor\"] = factory();\n\telse\n\t\troot[\"Perceptor\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","const config = {\n\t//\n\t//This denotes the threshold (Percentage) of surface area that an Element is considered to be visible\n\t// e.g, a. if threshold is 100, & if 100% of the Element is visible, it will be considered as visible\n\t// \t\tb. if threshold is 20, & %age element visibility >20 , it will be considered as visible\n\t// defaults to 100\n\tthreshold: 100,\n\n\twatchMode: 'interval', // interval, scroll, raf\n\twatchInterval: 500, // ms of interval time\n\n\tsubscribers: [],\n\tspectators: [],\n\tclickHandler: () => {}\n};\n\nexport default config;\n","const arrayMergeList = ['subscribers', 'spectators'];\nconst objectMergeList = ['watch'];\n\nconst isArray = candidate => {\n\treturn Array.isArray(candidate);\n};\nexport function mergeConfig(baseConfig, extensionConfig) {\n\tif (extensionConfig) {\n\t\tfor (var key in extensionConfig) {\n\t\t\tif (arrayMergeList.includes(key)) {\n\t\t\t\textensionConfig[key] = isArray(extensionConfig[key]) ? extensionConfig[key] : [extensionConfig[key]];\n\t\t\t\tbaseConfig[key] = baseConfig[key] || [];\n\t\t\t\tbaseConfig[key] = isArray(baseConfig[key]) ? baseConfig[key] : [baseConfig[key]];\n\t\t\t\textensionConfig[key] = [...baseConfig[key], ...extensionConfig[key]];\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (objectMergeList.includes(key)) {\n\t\t\t\tbaseConfig[key] = baseConfig[key] || {};\n\t\t\t\textensionConfig[key] = Object.assign({}, baseConfig[key], extensionConfig[key]);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn Object.assign({}, baseConfig, extensionConfig);\n}\n","// This reporter requires DOM Element which will be Absolute display,\n\nconst mainContainer = document.createElement('div');\nmainContainer.id = 'dreporter';\ndocument.body.appendChild(mainContainer);\n\nmainContainer.style.backgroundColor = '#e5e5e5';\nmainContainer.style.width = 'auto';\nmainContainer.style.position = 'fixed';\nmainContainer.style.bottom = '0';\nmainContainer.style.left = '0';\n\nvar paintObjectOnContainer = function(o) {\n\treturn `<pre>${JSON.stringify(o, undefined, 4)}</pre>`;\n};\n\nexport default (perceptorInstance, context) => {\n\tmainContainer.innerHTML = paintObjectOnContainer(context);\n};\n","export const getCurrentViewport = function() {\n\tif (document.documentElement && document.documentElement.clientHeight) {\n\t\treturn { ...getCurrentScrollPosition(), height: document.documentElement.clientHeight, width: document.documentElement.clientWidth };\n\t}\n\treturn { left: 0, right: 0, width: 0, height: 0 };\n};\n\nexport const getCurrentScrollPosition = function() {\n\treturn { left: window.pageXOffset, top: window.pageYOffset };\n};\n\nexport const getElementPosition = function(node) {\n\tlet position = node.getBoundingClientRect();\n\treturn { left: position.left, top: position.top, height: position.height, width: position.width };\n};\n\nexport const getCurrentViewportElementPosition = function(node) {\n\tlet position = getElementPosition(node);\n\tlet scrollPos = getCurrentScrollPosition();\n\treturn { left: position.left + scrollPos.left, top: position.top + scrollPos.top, height: position.height, width: position.width };\n};\n","import { getCurrentViewportElementPosition, getCurrentViewport } from '../utils/view';\n\nconst hasIntersectingArea = (lc, rc, tc, bc) => {\n\treturn (lc && tc) || (lc && bc) || (rc && tc) || (rc && bc);\n};\n\nexport default function viewPortSpectator(context) {\n\tlet ele = getCurrentViewportElementPosition(context.element);\n\tlet view = getCurrentViewport();\n\treturn isBoxed(view, ele, context.config);\n}\n\nexport const isBoxed = function(container, node, config) {\n\tconst threshold = config && config['threshold'] !== undefined ? config.threshold : 100;\n\tconst nodeRight = node.left + node.width;\n\tconst containerRight = container.left + container.width;\n\tconst nodeBottom = node.top + node.height;\n\tconst containerBottom = container.top + container.height;\n\n\tconst leftCoordinates = node.left >= container.left && node.left <= containerRight;\n\tconst rightCoordinates = nodeRight <= containerRight && nodeRight >= container.left;\n\tconst topCoordinates = node.top >= container.top && node.top <= containerBottom;\n\tconst bottomCoordinates = nodeBottom <= containerBottom && nodeBottom > container.top;\n\n\tconst subView = {};\n\n\tif (hasIntersectingArea(leftCoordinates, rightCoordinates, topCoordinates, bottomCoordinates)) {\n\t\tsubView.left = leftCoordinates ? node.left : container.left;\n\t\tsubView.right = rightCoordinates ? nodeRight : containerRight;\n\t\tsubView.top = topCoordinates ? node.top : container.top;\n\t\tsubView.bottom = bottomCoordinates ? nodeBottom : containerBottom;\n\t\tsubView.surface = ((((subView.right - subView.left) / node.width) * (subView.bottom - subView.top)) / node.height) * 100;\n\t}\n\n\treturn { isVisible: subView.surface >= threshold, subView };\n};\n","export default function timeSpectator() {\n\treturn { time: new Date().getTime() };\n}\n","export default function elementSpectator(pContext) {\n\tconst { element = {} } = pContext;\n\treturn { element: { id: element.id, tagName: element.tagName } };\n}\n","export default function durationSpectator(context, currentResult, prevResult) {\n\t/***\n\t *\n\t * This spectator depends on viewportSpectator and time spectator\n\t * Cases:\n\t * 1. Currently visible and previously not visible -> Just came under the view\n\t * 2. Currently visible and previously visible -> Add the count\n\t * 3. Currently not visible and previously not visible -> nothing to track\n\t * 4. Currently not visible and previously visible -> Got hidden\n\t *\n\t */\n\n\tlet { duration = 0 } = prevResult;\n\n\tif (currentResult.isVisible && prevResult.isVisible) {\n\t\tduration += currentResult.time - prevResult.time;\n\t}\n\n\treturn { duration };\n}\n","import viewPortSpectator from './viewportSpectator';\nimport timeSpectator from './timeSpectator';\nimport elementSpectator from './elementSpectator';\nimport durationSpectator from './durationSpectator';\n\nconst getDefaultSpectators = () => {\n\treturn [timeSpectator, elementSpectator, viewPortSpectator, durationSpectator];\n};\n\nexport default getDefaultSpectators;\n","export default class SpectatorManager {\n\tconstructor(chain) {\n\t\tthis.chain = chain || [];\n\t\tthis.prevResult = {};\n\t}\n\n\tuse(fn) {\n\t\t//todo :check whether it is a function\n\t\tthis.chain.push(fn);\n\t\treturn this.chain.length - 1;\n\t}\n\n\teject(id) {\n\t\tif (this.chain[id]) {\n\t\t\tthis.chain[id] = null;\n\t\t}\n\t}\n\n\trun(perceptorContext) {\n\t\tconst updatedResult = this.chain.reduce((currentResult, spectator) => {\n\t\t\tif (spectator) {\n\t\t\t\t//todo check result is an object\n\t\t\t\tcurrentResult = Object.assign(currentResult, spectator(perceptorContext, currentResult, this.prevResult));\n\t\t\t}\n\t\t\treturn currentResult;\n\t\t}, Object.assign({}, this.prevResult));\n\t\tthis.prevResult = updatedResult;\n\t\treturn updatedResult;\n\t}\n}\n","export default class SubscriberManager {\n\tconstructor(chain) {\n\t\tthis.chain = chain || [];\n\t}\n\n\tuse(fn) {\n\t\t//todo :check whether it is a function\n\t\tthis.chain.push(fn);\n\t\treturn this.chain.length - 1;\n\t}\n\n\teject(id) {\n\t\tif (this.chain[id]) {\n\t\t\tthis.chain[id] = null;\n\t\t}\n\t}\n\n\tdispatch(PerceptorContext, data) {\n\t\tthis.chain.every(subscribe => {\n\t\t\tif (subscribe) {\n\t\t\t\tsubscribe(PerceptorContext, data);\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\t}\n}\n","// Refer : https://developer.mozilla.org/en-US/docs/Web/API/Page_Visibility_API\n// Shouldn't need a polyfill with 'onblur', 'onfocus' since it seems to be supported by major browsers\n// Refer caniuse for browser support: https://caniuse.com/#search=pagevisibility\n\n// Set the name of the hidden property and the change event for visibility\nlet hidden, visibilityChange;\nif (typeof document.hidden !== 'undefined') {\n\t// Opera 12.10 and Firefox 18 and later support\n\thidden = 'hidden';\n\tvisibilityChange = 'visibilitychange';\n} else if (typeof document.msHidden !== 'undefined') {\n\thidden = 'msHidden';\n\tvisibilityChange = 'msvisibilitychange';\n} else if (typeof document.webkitHidden !== 'undefined') {\n\thidden = 'webkitHidden';\n\tvisibilityChange = 'webkitvisibilitychange';\n}\n\ndocument[hidden];\n\nexport const onPageVisible = (fn = () => {}) => {\n\tdocument.addEventListener(visibilityChange, fn, false);\n};\n\nexport const isPageVisible = () => {\n\treturn !document[hidden];\n};\n\nexport const isPageHidden = () => {\n\treturn document[hidden];\n};\n","import { isPageVisible, onPageVisible } from './visibilityHelper';\n\nexport default class IntervalScheduler {\n\tconstructor(options) {\n\t\t//todo: add validations here\n\t\tconst { interval = 500, spectatorChain, subscriberChain, context } = options;\n\t\tthis._enabled = true;\n\n\t\tthis._schedule(interval, spectatorChain, subscriberChain, context);\n\n\t\tonPageVisible(() => {\n\t\t\tthis._schedule(interval, spectatorChain, subscriberChain, context);\n\t\t});\n\t}\n\n\t_schedule(interval, spectatorChain, subscriberChain, context) {\n\t\tif (isPageVisible() && this._enabled) {\n\t\t\tthis.handleId = setInterval(() => {\n\t\t\t\tconst spectatorsResult = spectatorChain.run(context);\n\t\t\t\treturn subscriberChain.dispatch(context, spectatorsResult);\n\t\t\t}, interval);\n\t\t} else if (this._enabled) {\n\t\t\tclearInterval(this.handleId);\n\t\t}\n\t}\n\n\tclearSchedule() {\n\t\tclearInterval(this.handleId);\n\t\tthis._enabled = false;\n\t}\n}\n","import defaultConfig from './config/defaultConfig';\nimport { mergeConfig } from './config/helper';\nimport domSubscriber from './subscribers/domSubscriber';\nimport getDefaultSpectators from './spectators/defaultSpectators';\nimport SpectatorManager from './spectators/spectatorManager';\nimport SubscriberManager from './subscribers/subscriberManager';\nimport IntervalScheduler from './schedulers/intervalScheduler';\n\nclass Perceptor {\n\tconstructor(DOMElement, options = {}) {\n\t\tthis.element = DOMElement;\n\t\tthis.config = mergeConfig(Object.assign({}, defaultConfig, Perceptor.defaults, { subscribers: [domSubscriber], spectators: getDefaultSpectators() }), options);\n\t\tthis.spectatorChain = new SpectatorManager(this.config.spectators);\n\t\tthis.subscriberChain = new SubscriberManager(this.config.subscribers);\n\t\tthis.event = this.config.clickHandler ? this.config.clickHandler.bind(this, this) : () => {};\n\t}\n\n\twatch() {\n\t\tthis.scheduler = new IntervalScheduler({ context: this, subscriberChain: this.subscriberChain, spectatorChain: this.spectatorChain, interval: this.config.watchInterval });\n\t\tthis.element.addEventListener('click', this.event, false);\n\t}\n\n\tunwatch() {\n\t\tthis.scheduler.clearSchedule();\n\t\tthis.element.removeEventListener('click', this.event);\n\t}\n}\n\nPerceptor.defaults = Object.assign({}, defaultConfig);\n\nexport default Perceptor;\n"],"sourceRoot":""}